<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>

<BorderPane fx:controller="com.example.MainController" xmlns:fx="http://javafx.com/fxml">
    <top>
        <ToolBar>
            <ImageView fitHeight="24" fitWidth="24">
                <image>
                    <Image url="@/images/logo.png" />
                </image>
            </ImageView>
            <Label text="IDS Analytics" style="-fx-font-size: 16px; -fx-font-weight: bold;" />
            <Button text="📁 Import MDBs" onAction="#onFreshImportClicked" />
            <Button text="🔁 Merge MDBs" onAction="#onMergeImportClicked" />
            <Separator orientation="VERTICAL" />
            <Button text="🧪 Run Query" onAction="#onRunQueryClicked" />

            <!-- ✅ Fixed: Place MenuButton directly -->
            <Button text="📊 Predefined Queries" onAction="#onPredefinedQueryDialogClicked" />

            <Button fx:id="exportButton" text="💾 Export to CSV" onAction="#onExportClicked"
                visible="false" />

            <Pane HBox.hgrow="ALWAYS" />

            <ToggleButton fx:id="themeToggle" id="themeToggle" text="Dark Mode">
                <tooltip>
                    <Tooltip text="Toggle Dark/Light Mode" />
                </tooltip>
            </ToggleButton>
        </ToolBar>
    </top>

    <center>
        <SplitPane dividerPositions="0.25, 0.75">
            <VBox spacing="10.0" prefWidth="250">
                <Label text="📊 Tables" style="-fx-font-weight: bold;" />
                <TreeView fx:id="tableTreeView" VBox.vgrow="ALWAYS" />

                <HBox spacing="10">
                    <Label text="📦 Imported MDBs" style="-fx-font-weight: bold;" />
                    <Label fx:id="importedCountLabel" id="importedCountLabel" />
                </HBox>

                <TextField fx:id="mdbSearchField" promptText="Search imported MDBs..." />
                <ListView fx:id="mdbListView" VBox.vgrow="ALWAYS" />
                <Label text="❌ Failed Imports" style="-fx-font-weight: bold;" />
                <ListView fx:id="failedImportsListView" VBox.vgrow="ALWAYS" />
            </VBox>

            <VBox spacing="10">
                <Label text="📝 SQL Query:" style="-fx-font-weight: bold;" />
                <ScrollPane fitToHeight="true" fitToWidth="true" hbarPolicy="AS_NEEDED"
                    vbarPolicy="AS_NEEDED">
                    <TextArea fx:id="queryArea" prefRowCount="8" VBox.vgrow="NEVER" />
                </ScrollPane>
                <TableView fx:id="resultTable" VBox.vgrow="ALWAYS" />
            </VBox>
        </SplitPane>
    </center>

    <bottom>
        <HBox spacing="10">
            <Label fx:id="statusLabel" text="Ready." HBox.hgrow="ALWAYS" />
            <ProgressBar fx:id="importProgress" prefWidth="300" />
        </HBox>
    </bottom>
</BorderPane>